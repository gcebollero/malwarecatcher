{% extends "layout.tmpl" %}

        {% block title %}Settings{% endblock %}
        {% block content %}
<div class="container-fluid">
    <form method="post" action="/settings">
        <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
            <h5>Indexers</h5>
        </div>
        <div class="form-group row justify-content-md-center">
            <div class="col-1">
                <label class="mb-2 mr-2" for="HybridAnalysis_indexer">Hybrid Analysis</label>
            </div>
            <div class="col-6">
                <div class="input-group mb-2 mr-sm-2">
                    <div class="input-group-prepend">
                        <div class="input-group-text">
                            <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-key" fill="currentColor"
                                 xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd"
                                      d="M0 8a4 4 0 0 1 7.465-2H14a.5.5 0 0 1 .354.146l1.5 1.5a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0L13 9.207l-.646.647a.5.5 0 0 1-.708 0L11 9.207l-.646.647a.5.5 0 0 1-.708 0L9 9.207l-.646.647A.5.5 0 0 1 8 10h-.535A4 4 0 0 1 0 8zm4-3a3 3 0 1 0 2.712 4.285A.5.5 0 0 1 7.163 9h.63l.853-.854a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.793-.793-1-1h-6.63a.5.5 0 0 1-.451-.285A3 3 0 0 0 4 5z"/>
                                <path d="M4 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/>
                            </svg>
                        </div>
                    </div>
                    <input type="password" class="form-control" id="HybridAnalysis_indexer"
                        name="HybridAnalysis_indexer"
                        placeholder="Hybrid Analysis API-KEY" {% if api_keys.HybridAnalysis_indexer and
                        api_keys.HybridAnalysis_indexer.key != "" %} value="{{api_keys.HybridAnalysis_indexer.key}}"{% endif
                        %}/>
                </div>
            </div>
            <div class="col-2">
                <div class="form-check mb-2 mr-sm-2">
                    <div class="custom-control custom-switch">
                        <input type="checkbox" class="custom-control-input" id="HybridAnalysis_indexer_enabled"
                               name="HybridAnalysis_indexer_enabled"
                            {% if api_keys.HybridAnalysis_indexer and api_keys.HybridAnalysis_indexer.enabled ==
                            "on"%}checked{%
                            endif %}/>
                        <label class="custom-control-label" for="HybridAnalysis_indexer_enabled">Enable service</label>
                    </div>
                </div>
            </div>
        </div>
        <div class="form-group row justify-content-md-center">
            <div class="col-1">
                <label class="mb-2 mr-2" for="VT_indexer">VirusTotal</label>
            </div>
            <div class="col-6">
                <div class="input-group mb-2 mr-sm-2">
                    <div class="input-group-prepend">
                        <div class="input-group-text">
                            <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-key" fill="currentColor"
                                 xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd"
                                      d="M0 8a4 4 0 0 1 7.465-2H14a.5.5 0 0 1 .354.146l1.5 1.5a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0L13 9.207l-.646.647a.5.5 0 0 1-.708 0L11 9.207l-.646.647a.5.5 0 0 1-.708 0L9 9.207l-.646.647A.5.5 0 0 1 8 10h-.535A4 4 0 0 1 0 8zm4-3a3 3 0 1 0 2.712 4.285A.5.5 0 0 1 7.163 9h.63l.853-.854a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.793-.793-1-1h-6.63a.5.5 0 0 1-.451-.285A3 3 0 0 0 4 5z"/>
                                <path d="M4 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/>
                            </svg>
                        </div>
                    </div>
                    <input type="password" class="form-control" id="VT_indexer" name="VT_indexer"
                           placeholder="VirusTotal API-KEY"
                    {% if api_keys.VT_indexer and api_keys.VT_indexer.key != ""%}
                    value="{{api_keys.VT_indexer.key}}"{% endif %}/>
                </div>
            </div>
            <div class="col-2">
                <div class="form-check mb-2 mr-sm-2">
                    <div class="custom-control custom-switch">
                        <input type="checkbox" class="custom-control-input" id="VT_indexer_enabled"
                            name="VT_indexer_enabled"
                        {% if api_keys.VT_indexer and api_keys.VT_indexer.enabled == "on"%}checked{% endif %}/>
                        <label class="custom-control-label" for="VT_indexer_enabled">Enable service</label>
                    </div>
                </div>
            </div>
        </div>
        <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
            <h5>Crawlers</h5>
        </div>
        <div class="form-group row justify-content-md-center">
            <div class="col-1">
                <label class="mb-2 mr-2" for="HybridAnalysis_indexer">MalwareBazaar</label>
            </div>
            <div class="col-6">
                <div class="input-group mb-2 mr-sm-2">
                    <div class="input-group-prepend">
                        <div class="input-group-text">
                            <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-key" fill="currentColor"
                                 xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd"
                                      d="M0 8a4 4 0 0 1 7.465-2H14a.5.5 0 0 1 .354.146l1.5 1.5a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0L13 9.207l-.646.647a.5.5 0 0 1-.708 0L11 9.207l-.646.647a.5.5 0 0 1-.708 0L9 9.207l-.646.647A.5.5 0 0 1 8 10h-.535A4 4 0 0 1 0 8zm4-3a3 3 0 1 0 2.712 4.285A.5.5 0 0 1 7.163 9h.63l.853-.854a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.793-.793-1-1h-6.63a.5.5 0 0 1-.451-.285A3 3 0 0 0 4 5z"/>
                                <path d="M4 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/>
                            </svg>
                        </div>
                    </div>
                    <input type="password" class="form-control" placeholder="MalwareBazaar API-KEY" name="MalwareBazaar"
                    {% if api_keys['Crawlers.MalwareBazaar'] and api_keys['Crawlers.MalwareBazaar'].key != ""%}
                    value="{{api_keys['Crawlers.MalwareBazaar'].key}}"{% endif %}/>
                </div>
            </div>
            <div class="col-2">
                <div class="form-check mb-2 mr-sm-2">
                    <div class="custom-control custom-switch">
                        <input type="checkbox" class="custom-control-input" id="MalwareBazaar_enabled"
                               name="MalwareBazaar_enabled"
                            {% if api_keys['Crawlers.MalwareBazaar'] and api_keys['Crawlers.MalwareBazaar'].enabled ==
                            "on"%}checked{%
                            endif %}>
                        <label class="custom-control-label" for="MalwareBazaar_enabled">Enable service</label>
                    </div>
                </div>
            </div>
        </div>
        <div class="form-group row justify-content-md-center">
            <div class="col-1">
                <label class="mb-2 mr-2" for="MalShare">MalShare</label>
            </div>
            <div class="col-6">
                <div class="input-group mb-2 mr-sm-2">
                    <div class="input-group-prepend">
                        <div class="input-group-text">
                            <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-key" fill="currentColor"
                                 xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd"
                                      d="M0 8a4 4 0 0 1 7.465-2H14a.5.5 0 0 1 .354.146l1.5 1.5a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0L13 9.207l-.646.647a.5.5 0 0 1-.708 0L11 9.207l-.646.647a.5.5 0 0 1-.708 0L9 9.207l-.646.647A.5.5 0 0 1 8 10h-.535A4 4 0 0 1 0 8zm4-3a3 3 0 1 0 2.712 4.285A.5.5 0 0 1 7.163 9h.63l.853-.854a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.793-.793-1-1h-6.63a.5.5 0 0 1-.451-.285A3 3 0 0 0 4 5z"/>
                                <path d="M4 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/>
                            </svg>
                        </div>
                    </div>
                    <input type="password" class="form-control" id="MalShare"
                        name="MalShare"
                        placeholder="MalShare API-KEY" {% if api_keys['Crawlers.MalShare'] and
                        api_keys['Crawlers.MalShare'].key != "" %} value="{{api_keys['Crawlers.MalShare'].key}}"{% endif %}/>
                </div>
            </div>
            <div class="col-2">
                <div class="form-check mb-2 mr-sm-2">
                    <div class="custom-control custom-switch">
                        <input type="checkbox" class="custom-control-input" id="MalShare_enabled"
                               name="MalShare_enabled"
                            {% if api_keys['Crawlers.MalShare'] and api_keys['Crawlers.MalShare'].enabled == "on"%}checked{% endif %}/>
                        <label class="custom-control-label" for="MalShare_enabled">Enable service</label>
                    </div>
                </div>
            </div>
        </div>
        <div class="form-group row justify-content-end">
            <div class="col-1 align-self-end">
                <button type="submit" class="btn btn-secondary mb-2">Save</button>
            </div>
        </div>
    </form>
</div>
        {% endblock %}
        {% block script %}
<script></script>
        {% endblock %}