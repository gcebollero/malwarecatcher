{% extends "layout.tmpl" %}

{% block title %}Dashboard{% endblock %}
      {% block content %}
      <div class="container-fluid">
        <div class="row">
          <div class="col">
            <canvas class="my-4 w-100 chartjs-render-monitor" id="leftChart" width="1542" height="651" style="display: block; width: 1542px; height: 651px;"></canvas>
          </div>
        <div class="col">
          <canvas class="my-4 w-100 chartjs-render-monitor" id="centerChart" width="1542" height="651" style="display: block; width: 1542px; height: 651px;"></canvas>
        </div>
         <div class="col">
            <canvas class="my-4 w-100 chartjs-render-monitor" id="rightChart" width="1542" height="651" style="display: block; width: 1542px; height: 651px;"></canvas>
         </div>
      </div>
      <h2>Top 50 File tags</h2>
      <div class="table-responsive">
        <table class="table table-striped table-sm">
          <thead>
            <tr>
              <th>Tag</th>
              <th>#</th>
              <th>Tag</th>
              <th>#</th>
              <th>Tag</th>
              <th>#</th>
              <th>Tag</th>
              <th>#</th>
              <th>Tag</th>
              <th>#</th>
              <th>Tag</th>
              <th>#</th>
            </tr>
          </thead>
          <tbody>
          <tr>
          {% for key,value in tags.items() %}
            <td><a href="tag/{{key}}">{{key}}</a></td>
            <td>{{value}}</td>
            {% if loop.index is divisibleby 6 %}
            </tr>
            <tr>
              {% endif %}
           {% endfor %}
            </tr>
          </tbody>
        </table>
      </div>
      <h2>File types</h2>
      <div class="table-responsive">
        <table class="table table-striped table-sm">
          <thead>
            <tr>
              <th>File type</th>
              <th>#</th>
              <th>File type</th>
              <th>#</th>
              <th>File type</th>
              <th>#</th>
              <th>File type</th>
              <th>#</th>
              <th>File type</th>
              <th>#</th>
              <th>File type</th>
              <th>#</th>
            </tr>
          </thead>
          <tbody>
          <tr>
          {% for key, value in types.items() %}
            <td><a href="/type/{{key}}">{{key}}</a></td>
            <td>{{value}}</td>
            {% if loop.index is divisibleby 6 %}
            </tr>
            <tr>
              {% endif %}
           {% endfor %}
            </tr>
          </tbody>
        </table>
      </div>
{% endblock %}
{% block script %}
<script>
  'use strict'

var leftChart = new Chart(document.getElementById('leftChart'), {
    type: 'doughnut',
    data: {
      labels: [{% for item in stats.keys() if item%}{% if loop.index <= 10 %}'{{item}}'{% if not loop.last %}, {% endif %}{% endif %}{% endfor %}],
      datasets: [{
        data: [{% for item in stats.values()%}{% if loop.index <= 10 %}{{item}}{% if not loop.last %}, {% endif %}{% endif %}{% endfor %}],
        backgroundColor: [
          '#ff033e',
          '#8db600'
        ],
        borderWidth: 4,
        pointBackgroundColor: '#007bff'
      }]
    },
    options: {
      scales: {
        yAxes: [{
          ticks: {
            beginAtZero: false
          }
        }]
      },
      legend: {
        display: true
      },
      title: {
        display: true,
        text: 'File indexation status'
      }
    }
  });

  var centerChart = new Chart(document.getElementById('centerChart'), {
    type: 'horizontalBar',
    data: {
      labels: [{% for item in types.keys()%}{% if loop.index <= 10 %}'{{item}}'{% if not loop.last %}, {% endif %}{% endif %}{% endfor %}],
      datasets: [
        {
          label: "File type occurrences",
          backgroundColor: ["#eb7d1b", "#ed872d","#ef913f","#f09c51","#f2a663","#f3b075","#f5bb87","#f6c599","#f8cfab","#f9dabe"],
          data: [{% for item in types.values()%}{% if loop.index <= 10 %}{{item}}{% if not loop.last %}, {% endif %}{% endif %}{% endfor %}]
        }
      ]
    },
    options: {
      legend: { display: false },
      title: {
        display: true,
        text: 'Top 10 file types'
      }
    }
});

  var rightChart = new Chart(document.getElementById('rightChart'), {
    type: 'horizontalBar',
    data: {
      labels: [{% for item in tags.keys()%}{% if loop.index <= 10 and loop.index != 1 %}'{{item}}'{% if not loop.last %}, {% endif %}{% endif %}{% endfor %}],
      datasets: [
        {
          label: "File tag occurrences)",
          backgroundColor: ["#08bfff", "#1cc4ff","#2fc9ff","#43ceff","#57d3ff","#6ad8ff","#7eddff","#91e2ff","#a5e8ff","#b9edff"],
          data: [{% for item in tags.values()%}{% if loop.index <= 10 and loop.index != 1 %}{{item}}{% if not loop.last %}, {% endif %}{% endif %}{% endfor %}]
        }
      ]
    },
    options: {
      legend: { display: false },
      title: {
        display: true,
        text: 'Top 10 file tags'
      }
    }
});
</script>
{% endblock %}